VERSION 5.00
Begin VB.Form Form1 
   Caption         =   "Form1"
   ClientHeight    =   5430
   ClientLeft      =   120
   ClientTop       =   450
   ClientWidth     =   5670
   LinkTopic       =   "Form1"
   ScaleHeight     =   5430
   ScaleWidth      =   5670
   StartUpPosition =   3  '窗口缺省
   Begin VB.Timer Timer2 
      Interval        =   2500
      Left            =   360
      Top             =   5040
   End
   Begin VB.Timer Timer1 
      Left            =   0
      Top             =   5040
   End
   Begin VB.Shape Shape1 
      BackColor       =   &H00000000&
      BorderColor     =   &H00000000&
      Height          =   135
      Index           =   53
      Left            =   0
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   52
      Left            =   240
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   51
      Left            =   480
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   50
      Left            =   720
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   49
      Left            =   960
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   48
      Left            =   1200
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      BackColor       =   &H00000000&
      BorderColor     =   &H00000000&
      Height          =   135
      Index           =   47
      Left            =   0
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   46
      Left            =   240
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   45
      Left            =   480
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   44
      Left            =   720
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   43
      Left            =   960
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   42
      Left            =   1200
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      BackColor       =   &H00000000&
      BorderColor     =   &H00000000&
      Height          =   135
      Index           =   41
      Left            =   0
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   40
      Left            =   240
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   39
      Left            =   480
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   38
      Left            =   720
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   37
      Left            =   960
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   36
      Left            =   1200
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      BackColor       =   &H00000000&
      BorderColor     =   &H00000000&
      Height          =   135
      Index           =   35
      Left            =   0
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   34
      Left            =   240
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   33
      Left            =   480
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   32
      Left            =   720
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   31
      Left            =   960
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   30
      Left            =   1200
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   29
      Left            =   1200
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   28
      Left            =   960
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   27
      Left            =   720
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   26
      Left            =   480
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   25
      Left            =   240
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      BackColor       =   &H00000000&
      BorderColor     =   &H00000000&
      Height          =   135
      Index           =   24
      Left            =   0
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   23
      Left            =   1200
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   22
      Left            =   960
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   21
      Left            =   720
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   20
      Left            =   480
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   19
      Left            =   240
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      BackColor       =   &H00000000&
      BorderColor     =   &H00000000&
      Height          =   135
      Index           =   18
      Left            =   0
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   17
      Left            =   1200
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   16
      Left            =   960
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   15
      Left            =   720
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   14
      Left            =   480
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   13
      Left            =   240
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      BackColor       =   &H00000000&
      BorderColor     =   &H00000000&
      Height          =   135
      Index           =   12
      Left            =   0
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   11
      Left            =   1200
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   10
      Left            =   960
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   9
      Left            =   720
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   8
      Left            =   480
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   7
      Left            =   240
      Top             =   0
      Width           =   135
   End
   Begin VB.Shape Shape1 
      BackColor       =   &H00000000&
      BorderColor     =   &H00000000&
      Height          =   135
      Index           =   6
      Left            =   0
      Top             =   0
      Width           =   135
   End
   Begin VB.Label Label1 
      Caption         =   "0"
      Height          =   255
      Left            =   5160
      TabIndex        =   0
      Top             =   0
      Width           =   495
   End
   Begin VB.Image Image1 
      Height          =   135
      Left            =   -240
      Picture         =   "Form1.frx":0000
      Stretch         =   -1  'True
      Top             =   -240
      Width           =   135
   End
   Begin VB.Shape Shape1 
      BackColor       =   &H00000000&
      BorderColor     =   &H00000000&
      Height          =   135
      Index           =   5
      Left            =   0
      Top             =   240
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   4
      Left            =   240
      Top             =   240
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   3
      Left            =   480
      Top             =   240
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   2
      Left            =   720
      Top             =   240
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   1
      Left            =   960
      Top             =   240
      Width           =   135
   End
   Begin VB.Shape Shape1 
      Height          =   135
      Index           =   0
      Left            =   1200
      Top             =   240
      Width           =   135
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim cd As Integer '长度
Dim fs As Integer '分数
Dim xpy As Boolean
Dim fx As Integer '1右 2下 3左 4上 0停(?)

Private Sub Form_KeyDown(KC As Integer, Shift As Integer)
If KC = 38 And fx <> 2 Then
 fx = 4
ElseIf KC = 40 And fx <> 4 Then
 fx = 2
ElseIf KC = 37 And fx <> 1 Then
 fx = 3
ElseIf KC = 39 And fx <> 3 Then
 fx = 1
End If

End Sub

Private Sub Form_Load()
For p = 6 To 53
 Shape1(p).Top = -2400
 Shape1(p).Left = -2400
Next p
fx = 1 '默认方向向右
Timer1.Enabled = True
Timer1.Interval = 200
xpy = True
fs = 0
Label1.Caption = Str(fs)
cd = 5 '初始长度为6
Randomize
End Sub

Private Sub Timer1_Timer()
For i = cd To 1 Step -1
 Shape1(i).Left = Shape1(i - 1).Left
 Shape1(i).Top = Shape1(i - 1).Top
Next i
If fx = 1 Then
 Shape1(0).Left = Shape1(0).Left + 240
ElseIf fx = 2 Then
 Shape1(0).Top = Shape1(0).Top + 240
ElseIf fx = 3 Then
 Shape1(0).Left = Shape1(0).Left - 240
ElseIf fx = 4 Then
 Shape1(0).Top = Shape1(0).Top - 240
End If
If Shape1(0).Left < 0 Or Shape1(0).Top < 0 Or Shape1(0).Top > 5280 Or Shape1(0).Left > 5520 Then '碰壁判定
 MsgBox "你输了,你的分数为" + CStr(fs)
 fs = 0
 Label1.Caption = Str(fs)
 Shape1(0).Left = -240
 Shape1(0).Top = 0
 fx = 1
 For p = 6 To 53
  Shape1(p).Top = -2400
  Shape1(p).Left = -2400
 Next p
 cd = 5
End If
For j = cd To 1 Step -1 '吃尾判定
 If Shape1(0).Top = Shape1(j).Top And Shape1(0).Left = Shape1(j).Left Then
  MsgBox "你输了,你的分数为" + CStr(fs)
  fs = 0
  Label1.Caption = Str(fs)
  Shape1(0).Left = -240
  Shape1(0).Top = 0
  fx = 1
  For p = 6 To 53
   Shape1(p).Top = -2400
   Shape1(p).Left = -2400
  Next p
  cd = 5
 End If
Next j
If Shape1(0).Left = Image1.Left And Shape1(0).Top = Image1.Top Then '目标判定
 fs = fs + 100
 xpy = True
 Label1.Caption = Str(fs)
 Image1.Left = -240
 Image1.Top = -240
 If cd < 53 Then
  cd = cd + 3
 End If
End If
End Sub

Private Sub Timer2_Timer() '目标刷新
Randomize
If xpy Then
 Image1.Left = Int(Rnd() * 24) * 240
 Image1.Top = Int(Rnd() * 23) * 240
 xpy = False
End If
End Sub
